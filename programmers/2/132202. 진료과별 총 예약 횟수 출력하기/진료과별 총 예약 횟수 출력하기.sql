# -- 코드를 입력하세요
# SELECT MCDP_CD as '진료과코드', COUNT(*) as '5월예약건수'
# FROM APPOINTMENT
# WHERE APNT_YMD BETWEEN '2022-05-01' AND '2022-05-31' and 
#     (APNT_CNCL_YMD not BETWEEN '2022-05-01' AND '2022-05-31' OR APNT_CNCL_YMD is NULL)
# GROUP BY MCDP_CD
# ORDER BY COUNT(*), MCDP_CD DESC
# SELECT *
# FROM APPOINTMENT
# WHERE APNT_YMD BETWEEN '2022-05-01' AND '2022-05-31'

SELECT MCDP_CD AS 진료과코드, COUNT(APNT_YMD) AS 5월예약건수
FROM APPOINTMENT
WHERE MONTH(APNT_YMD) = 5 AND YEAR(APNT_YMD) = 2022
GROUP BY MCDP_CD
ORDER BY 5월예약건수,MCDP_CD;